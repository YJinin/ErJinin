# 门禁系统——矩阵按键



##  一、实现原理

1. **矩阵按键扫描逻辑：**

   在矩阵按键电路中，将**行引脚设为推挽输出、列引脚设为上拉输入**，是通过 “主动驱动 + 被动检测” 的组合，实现按键的精准识别：

   - 矩阵按键的 “行” 需要主动输出电平，作为按键检测的 “驱动信号”：

   当需要扫描某一行时，**将该行的推挽输出引脚设为低电平**，其他行设为高电平

   若该行有按键按下，按下的按键会将对应的 “列引脚” 与当前行的低电平连通，从而让列引脚的电平被拉低）。

   - 矩阵按键的 “列” 需要检测是否被行的电平拉低，因此用 “上拉输入”：

   列引脚默认由内部上拉电阻保持高电平（无按键按下时，列是高电平）

   当某一行被设为低电平，且该行对应的按键被按下时，按键会将 “当前行的低电平” 传导到对应的列引脚，此时列引脚的电平被拉低,单片机通过读取列引脚的输入状态，即可判断 “哪一列的按键被按下”

   

   > **推挽输出**:    I/O 口能主动输出高电平（VCC）或低电平（GND），驱动能力强，可直接控制外部电路的电平；如果行用 “开漏输出”，只能主动拉低电平、无法主动输出高电平（需外部上拉），会增加硬件复杂度。
   >
   > **上拉输入**：I/O 口默认通过内部上拉电阻保持高电平，当外部电路将引脚拉低时，能检测到电平变化（输入状态由外部信号决定）。如果列用 “浮空输入”，无按键按下时引脚会处于 “悬空状态”，电平不稳定（易受干扰）

2. **实现方式**：循环嵌套



##  知识点补充

1. 下拉输入：当一个 GPIO 引脚被配置为**下拉输入**时，单片机内部会连接一个电阻到 GND（地）

> - **在外部电路没有驱动信号时**，将引脚电平**稳定在低电平（0V）**。这可以防止引脚悬空，避免因电磁干扰等因素导致电平随机跳变，从而保证输入信号的稳定性。
> - **当外部电路有驱动信号时**，内部下拉电阻的作用就会被外部信号 “覆盖”